<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seller Dashboard - MuaRight</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../../public/CSS/seller/homeSellerPage.css">
</head>
<body>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h4>
                <div class="logo-icon">
                    <i class="fas fa-gem"></i>
                </div>
                <span>MuaRight</span>
            </h4>
        </div>
        <ul class="sidebar-menu">
            <li><a href="homeSeller_page.html" class="active"><i class="fas fa-chart-line"></i> Dashboard</a></li>
            <li><a href="products_page.html"><i class="fas fa-box"></i> Qu·∫£n l√Ω s·∫£n ph·∫©m</a></li>
            <li><a href="orders_page.html"><i class="fas fa-shopping-cart"></i> Qu·∫£n l√Ω ƒë∆°n h√†ng</a></li>
            <li><a href="satisfaction_page.html"><i class="fas fa-chart-bar"></i> Th·ªëng k√™ doanh thu</a></li>
            <li><a href="#settings"><i class="fas fa-cog"></i> C√†i ƒë·∫∑t</a></li>
            <li><a href="#logout"><i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t</a></li>
        </ul>
    </div>

    <div class="main-content">
        <div class="top-bar">
            <div>
                <h5>Xin ch√†o, <span id="sellerName">Seller</span></h5>
                <small class="text-muted">Ch√†o m·ª´ng tr·ªü l·∫°i v·ªõi MuaRight Seller Center</small>
            </div>
            <div class="user-info">
                <div>
                    <div class="text-end">
                        <small class="text-muted d-block">H√¥m nay</small>
                        <strong id="currentDate" style="color: var(--primary-dark);"></strong>
                    </div>
                </div>
                <div class="user-avatar" id="userAvatar">NA</div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="stats-card revenue">
                    <div class="icon-wrapper">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <h3 id="monthRevenue">0ƒë</h3>
                    <p>Doanh thu th√°ng n√†y</p>
                    <span class="trend up" id="revenueTrend">
                        <i class="fas fa-arrow-up"></i> +0%
                    </span>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="stats-card orders">
                    <div class="icon-wrapper">
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <h3 id="monthOrders">0</h3>
                    <p>ƒê∆°n h√†ng th√°ng n√†y</p>
                    <span class="trend up" id="ordersTrend">
                        <i class="fas fa-arrow-up"></i> +0%
                    </span>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="stats-card products">
                    <div class="icon-wrapper">
                        <i class="fas fa-box-open"></i>
                    </div>
                    <h3 id="totalProducts">0</h3>
                    <p>S·∫£n ph·∫©m ƒëang b√°n</p>
                    <span class="trend up" id="productsTrend">
                        <i class="fas fa-plus"></i> +0 m·ªõi
                    </span>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4">
                <div class="stats-card pending">
                    <div class="icon-wrapper">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h3 id="pendingOrders">0</h3>
                    <p>ƒê∆°n ch·ªù x·ª≠ l√Ω</p>
                    <span class="trend down" id="pendingTrend">
                        <i class="fas fa-exclamation-triangle"></i> C·∫ßn x·ª≠ l√Ω
                    </span>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <span><i class="fas fa-list"></i> ƒê∆°n h√†ng g·∫ßn ƒë√¢y</span>
                        <a href="orders_page.html" class="btn btn-sm btn-outline-primary">Xem t·∫•t c·∫£</a>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table mb-0">
                                <thead>
                                    <tr>
                                        <th>M√£ ƒë∆°n</th>
                                        <th>S·∫£n ph·∫©m</th>
                                        <th>Kh√°ch h√†ng</th>
                                        <th>S·ªë l∆∞·ª£ng</th>
                                        <th>T·ªïng ti·ªÅn</th>
                                        <th>Tr·∫°ng th√°i</th>
                                        <th>Thao t√°c</th>
                                    </tr>
                                </thead>
                                <tbody id="recentOrdersTable">
                                    <!-- Orders will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-6 mb-4">
                <div class="card">
                    <div class="card-header">
                        <span><i class="fas fa-trophy"></i> Top 5 s·∫£n ph·∫©m b√°n ch·∫°y</span>
                    </div>
                    <div class="card-body" id="topProductsList">
                        <!-- Top products will be loaded here -->
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6 mb-4">
                <div class="card">
                    <div class="card-header">
                        <span><i class="fas fa-bell"></i> Th√¥ng b√°o m·ªõi nh·∫•t</span>
                    </div>
                    <div class="card-body" id="notificationsList">
                        <!-- Notifications will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button class="btn mobile-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Dashboard data - will be fetched from API
        let dashboardData = {
            seller: {
                name: 'Nguy·ªÖn VƒÉn A',
                email: 'seller@muaright.com'
            },
            stats: {
                monthRevenue: 45200000,
                revenueTrend: 12.5,
                monthOrders: 156,
                ordersTrend: 8.2,
                totalProducts: 48,
                newProducts: 2,
                pendingOrders: 12
            },
            recentOrders: [
                { id: 'DH001', product: 'Chanel No.5 EDP 100ml', customer: 'Nguy·ªÖn VƒÉn A', qty: 1, total: 3500000, status: 'pending' },
                { id: 'DH002', product: 'Dior Sauvage EDT 60ml', customer: 'Tr·∫ßn Th·ªã B', qty: 2, total: 4200000, status: 'confirmed' },
                { id: 'DH003', product: 'Versace Eros Pour Homme', customer: 'L√™ VƒÉn C', qty: 1, total: 2100000, status: 'shipping' },
                { id: 'DH004', product: 'Gucci Bloom EDP 50ml', customer: 'Ph·∫°m Th·ªã D', qty: 1, total: 2800000, status: 'delivered' },
                { id: 'DH005', product: 'Tom Ford Black Orchid', customer: 'Ho√†ng VƒÉn E', qty: 1, total: 4500000, status: 'pending' }
            ],
            topProducts: [
                { name: 'Chanel No.5 EDP', sold: 45, badge: 'ü•á Top 1' },
                { name: 'Dior Sauvage EDT', sold: 38, badge: 'ü•à Top 2' },
                { name: 'Versace Eros', sold: 32, badge: 'ü•â Top 3' },
                { name: 'Gucci Bloom', sold: 28, badge: 'Top 4' },
                { name: 'Tom Ford Black Orchid', sold: 25, badge: 'Top 5' }
            ],
            notifications: [
                { type: 'warning', icon: 'exclamation-circle', title: 'ƒê∆°n h√†ng m·ªõi', message: 'B·∫°n c√≥ 3 ƒë∆°n h√†ng m·ªõi c·∫ßn x√°c nh·∫≠n ngay', time: '5 ph√∫t tr∆∞·ªõc' },
                { type: 'info', icon: 'box', title: 'S·∫£n ph·∫©m s·∫Øp h·∫øt h√†ng', message: 'Chanel No.5 ch·ªâ c√≤n 5 s·∫£n ph·∫©m trong kho', time: '1 gi·ªù tr∆∞·ªõc' },
                { type: 'success', icon: 'star', title: 'ƒê√°nh gi√° t√≠ch c·ª±c', message: 'S·∫£n ph·∫©m Dior Sauvage nh·∫≠n ƒë√°nh gi√° 5 sao', time: '2 gi·ªù tr∆∞·ªõc' }
            ]
        };

        document.addEventListener('DOMContentLoaded', function() {
            loadDashboard();
            updateDateTime();
        });

        function loadDashboard() {
            // TODO: Replace with API call
            // fetch('/api/seller/dashboard')
            //     .then(res => res.json())
            //     .then(data => {
            //         dashboardData = data;
            //         updateDashboard();
            //     });
            
            updateDashboard();
        }

        function updateDashboard() {
            // Update seller info
            document.getElementById('sellerName').textContent = dashboardData.seller.name;
            const initials = dashboardData.seller.name.split(' ').map(n => n[0]).join('').substring(0, 2);
            document.getElementById('userAvatar').textContent = initials;

            // Update stats
            document.getElementById('monthRevenue').textContent = formatPrice(dashboardData.stats.monthRevenue);
            document.getElementById('revenueTrend').innerHTML = `<i class="fas fa-arrow-up"></i> +${dashboardData.stats.revenueTrend}%`;
            
            document.getElementById('monthOrders').textContent = dashboardData.stats.monthOrders;
            document.getElementById('ordersTrend').innerHTML = `<i class="fas fa-arrow-up"></i> +${dashboardData.stats.ordersTrend}%`;
            
            document.getElementById('totalProducts').textContent = dashboardData.stats.totalProducts;
            document.getElementById('productsTrend').innerHTML = `<i class="fas fa-plus"></i> +${dashboardData.stats.newProducts} m·ªõi`;
            
            document.getElementById('pendingOrders').textContent = dashboardData.stats.pendingOrders;

            // Load recent orders
            loadRecentOrders();
            
            // Load top products
            loadTopProducts();
            
            // Load notifications
            loadNotifications();
        }

        function loadRecentOrders() {
            const tbody = document.getElementById('recentOrdersTable');
            tbody.innerHTML = '';

            const statusConfig = {
                pending: { class: 'bg-warning', text: 'Ch·ªù x√°c nh·∫≠n' },
                confirmed: { class: 'bg-info', text: 'ƒê√£ x√°c nh·∫≠n' },
                shipping: { class: 'bg-primary', text: 'ƒêang giao' },
                delivered: { class: 'bg-success', text: 'ƒê√£ giao' }
            };

            dashboardData.recentOrders.forEach(order => {
                const config = statusConfig[order.status];
                const row = `
                    <tr>
                        <td><strong>#${order.id}</strong></td>
                        <td>${order.product}</td>
                        <td>${order.customer}</td>
                        <td>${order.qty}</td>
                        <td><strong style="color: var(--primary-orange);">${formatPrice(order.total)}</strong></td>
                        <td><span class="badge ${config.class}">${config.text}</span></td>
                        <td>
                            ${order.status === 'pending' 
                                ? '<button class="btn btn-sm btn-success" onclick="confirmOrder(\'' + order.id + '\')">X√°c nh·∫≠n</button>'
                                : '<button class="btn btn-sm btn-primary" onclick="viewOrder(\'' + order.id + '\')">Chi ti·∫øt</button>'
                            }
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function loadTopProducts() {
            const container = document.getElementById('topProductsList');
            container.innerHTML = '';

            const badges = ['bg-warning', 'bg-info', 'bg-primary', 'bg-success', 'bg-success'];

            dashboardData.topProducts.forEach((product, index) => {
                const item = `
                    <div class="product-item">
                        <div>
                            <strong>${product.name}</strong><br>
                            <small class="text-muted">${product.sold} ƒë∆°n b√°n ra</small>
                        </div>
                        <span class="badge ${badges[index]}">${product.badge}</span>
                    </div>
                `;
                container.innerHTML += item;
            });
        }

        function loadNotifications() {
            const container = document.getElementById('notificationsList');
            container.innerHTML = '';

            dashboardData.notifications.forEach(notif => {
                const item = `
                    <div class="notification-item">
                        <div class="d-flex gap-3">
                            <div class="notification-icon ${notif.type}">
                                <i class="fas fa-${notif.icon}"></i>
                            </div>
                            <div class="flex-grow-1">
                                <strong>${notif.title}</strong><br>
                                <small class="text-muted">${notif.message}</small><br>
                                <small class="text-muted"><i class="far fa-clock"></i> ${notif.time}</small>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += item;
            });
        }

        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(price);
        }

        function updateDateTime() {
            const dateElement = document.getElementById('currentDate');
            const today = new Date();
            const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
            dateElement.textContent = today.toLocaleDateString('vi-VN', options);
        }

        function confirmOrder(orderId) {
            if (confirm('X√°c nh·∫≠n ƒë∆°n h√†ng n√†y?')) {
                // TODO: Replace with API call
                // fetch('/api/seller/orders/' + orderId + '/confirm', { method: 'PUT' })
                //     .then(res => res.json())
                //     .then(data => {
                //         alert('ƒê√£ x√°c nh·∫≠n ƒë∆°n h√†ng th√†nh c√¥ng!');
                //         loadDashboard();
                //     });
                
                alert('ƒê√£ x√°c nh·∫≠n ƒë∆°n h√†ng th√†nh c√¥ng!');
                window.location.href = 'orders_page.html';
            }
        }

        function viewOrder(orderId) {
            // TODO: Navigate to order detail or open modal
            window.location.href = 'orders_page.html';
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('show');
        }

        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.querySelector('.mobile-toggle');
            
            if (window.innerWidth <= 768) {
                if (!sidebar.contains(event.target) && !toggle.contains(event.target)) {
                    sidebar.classList.remove('show');
                }
            }
        });

        const menuLinks = document.querySelectorAll('.sidebar-menu a');
        menuLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                if (!this.getAttribute('href').startsWith('#')) return;
                e.preventDefault();
                menuLinks.forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            });
        });
    </script>
</body>
</html>